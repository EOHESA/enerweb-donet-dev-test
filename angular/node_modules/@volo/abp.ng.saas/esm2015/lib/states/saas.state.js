import{__decorate,__rest}from"tslib";import{Injectable}from"@angular/core";import{Action,Selector,State}from"@ngxs/store";import{tap}from"rxjs/operators";import{CreateEdition,CreateTenant,DeleteEdition,DeleteTenant,GetEditions,GetLatestTenants,GetTenants,GetUsageStatistics,UpdateEdition,UpdateTenant}from"../actions/saas.actions";import{EditionService}from"../proxy/host/edition.service";import{TenantService}from"../proxy/host/tenant.service";let SaasState=class{constructor(t,e){this.tenantService=t,this.editionService=e}static getTenants({tenants:t}){return t.items||[]}static getLatestTenants({latestTenants:t}){return t}static getTenantsTotalCount({tenants:t}){return t.totalCount||0}static getEditions({editions:t}){return t.items||[]}static getEditionsTotalCount({editions:t}){return t.totalCount||0}static getUsageStatistics({usageStatistics:t}){return t}getTenants({patchState:t},{payload:e}){return this.tenantService.getList(e).pipe(tap(e=>t({tenants:e})))}deleteTenant(t,{payload:e}){return this.tenantService.delete(e)}createTenant(t,{payload:e}){return this.tenantService.create(e)}updateTenant(t,e){var a=e.payload,{id:n}=a,i=__rest(a,["id"]);return this.tenantService.update(n,i)}getEditions({patchState:t},{payload:e}){return this.editionService.getList(e).pipe(tap(e=>t({editions:e})))}deleteEdition(t,{payload:e}){return this.editionService.delete(e)}createEdition(t,{payload:e}){return this.editionService.create(e)}updateEdition(t,e){var a=e.payload,{id:n}=a,i=__rest(a,["id"]);return this.editionService.update(n,i)}getUsage({patchState:t}){return this.editionService.getUsageStatistics().pipe(tap(e=>{t({usageStatistics:e.data})}))}getLatestTenants({patchState:t}){return this.tenantService.getList({getEditionNames:!0,maxResultCount:6,skipCount:0,sorting:"CreationTime desc"}).pipe(tap(e=>{t({latestTenants:e.items})}))}};SaasState.decorators=[{type:Injectable}],SaasState.ctorParameters=()=>[{type:TenantService},{type:EditionService}],__decorate([Action(GetTenants)],SaasState.prototype,"getTenants",null),__decorate([Action(DeleteTenant)],SaasState.prototype,"deleteTenant",null),__decorate([Action(CreateTenant)],SaasState.prototype,"createTenant",null),__decorate([Action(UpdateTenant)],SaasState.prototype,"updateTenant",null),__decorate([Action(GetEditions)],SaasState.prototype,"getEditions",null),__decorate([Action(DeleteEdition)],SaasState.prototype,"deleteEdition",null),__decorate([Action(CreateEdition)],SaasState.prototype,"createEdition",null),__decorate([Action(UpdateEdition)],SaasState.prototype,"updateEdition",null),__decorate([Action(GetUsageStatistics)],SaasState.prototype,"getUsage",null),__decorate([Action(GetLatestTenants)],SaasState.prototype,"getLatestTenants",null),__decorate([Selector()],SaasState,"getTenants",null),__decorate([Selector()],SaasState,"getLatestTenants",null),__decorate([Selector()],SaasState,"getTenantsTotalCount",null),__decorate([Selector()],SaasState,"getEditions",null),__decorate([Selector()],SaasState,"getEditionsTotalCount",null),__decorate([Selector()],SaasState,"getUsageStatistics",null),SaasState=__decorate([State({name:"SaasState",defaults:{tenants:{},editions:{},latestTenants:[],usageStatistics:{}}})],SaasState);export{SaasState};