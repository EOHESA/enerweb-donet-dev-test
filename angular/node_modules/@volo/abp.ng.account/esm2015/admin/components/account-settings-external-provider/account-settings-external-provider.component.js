import{__rest}from"tslib";import{Component,ChangeDetectionStrategy}from"@angular/core";import{map}from"rxjs/operators";import{AbstractAccountSettingsService}from"../../abstracts/abstract-account-config.service";import{AccountExternalProviderService}from"../../services/account-external-provider.service";import{AbstractAccountSettingsComponent}from"../../abstracts/abstract-account-settings.component";export class AccountSettingsExternalProviderComponent extends AbstractAccountSettingsComponent{constructor(){super(...arguments),this.mapInitialTenantSettings=t=>({settings:t.settings.filter(t=>t.enabled).map(this.setUseHostSettingsOf)})}ngOnInit(){this.isTenant?this.settings$=this.service.getSettings().pipe(map(this.mapInitialTenantSettings)):super.ngOnInit()}mapTenantSettingsForSubmit(t){return t.map(this.clearPropertyValues)}clearPropertyValues(t){t.useHostSettings&&(t.properties.forEach(t=>t.value=""),t.secretProperties.forEach(t=>t.value=""));const{useHostSettings:e}=t;return __rest(t,["useHostSettings"])}setUseHostSettingsOf(t){const e=!(t.properties.some(t=>t.value)||t.secretProperties.some(t=>t.value));return Object.assign(Object.assign({},t),{useHostSettings:e})}}AccountSettingsExternalProviderComponent.decorators=[{type:Component,args:[{selector:"abp-account-settings-external-provider",template:'<ng-container *ngIf="settings$ | async; let settings">\r\n  <div (keyup.enter)="submit(settings.settings)">\r\n    <ng-container *ngFor="let provider of settings.settings">\r\n      <ng-container *ngIf="isTenant; else host">\r\n        <ng-container>\r\n          <h4>{{ provider.name }}</h4>\r\n          <div class="custom-control custom-checkbox">\r\n            <input\r\n              type="checkbox"\r\n              class="custom-control-input"\r\n              [attr.id]="provider.name + \'.use-host-settings\'"\r\n              [(ngModel)]="provider.useHostSettings"\r\n            />\r\n            <label class="custom-control-label" [for]="provider.name + \'.use-host-settings\'">{{\r\n              \'AbpAccount::ExternalProviderUseHostSettings\' | abpLocalization\r\n            }}</label>\r\n          </div>\r\n\r\n          <div class="collapse" [class.show]="!provider.useHostSettings">\r\n            <ng-container *ngTemplateOutlet="propertySetsTemplate"></ng-container>\r\n          </div>\r\n\r\n          <hr class="my-4" />\r\n        </ng-container>\r\n      </ng-container>\r\n\r\n      <ng-template #host>\r\n        <h4>{{ provider.name }}</h4>\r\n\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            [attr.id]="provider.name + \'.enabled\'"\r\n            [attr.name]="provider.name + \'.enabled\'"\r\n            class="custom-control-input"\r\n            [(ngModel)]="provider.enabled"\r\n            autofocus\r\n          /><label class="custom-control-label" [attr.for]="provider.name + \'.enabled\'">{{\r\n            \'AbpAccount::ExternalProviderEnabled\' | abpLocalization\r\n          }}</label>\r\n        </div>\r\n\r\n        <ng-container *ngTemplateOutlet="propertySetsTemplate"></ng-container>\r\n      </ng-template>\r\n\r\n      <ng-template #propertySetsTemplate>\r\n        <ng-container\r\n          *ngTemplateOutlet="singlePropertySetTemplate; context: { $implicit: provider.properties }"\r\n        ></ng-container>\r\n        <ng-container\r\n          *ngTemplateOutlet="\r\n            singlePropertySetTemplate;\r\n            context: { $implicit: provider.secretProperties, type: \'password\' }\r\n          "\r\n        ></ng-container>\r\n\r\n        <ng-template #singlePropertySetTemplate let-properties let-type="type">\r\n          <ng-container *ngFor="let property of properties">\r\n            <div class="form-group">\r\n              <label [attr.for]="provider.name + \'.\' + property.name">{{ property.name }}</label>\r\n              <input\r\n                [type]="type || \'text\'"\r\n                class="form-control"\r\n                [(ngModel)]="property.value"\r\n                [attr.id]="provider.name + \'.\' + property.name"\r\n              />\r\n            </div>\r\n          </ng-container>\r\n        </ng-template>\r\n      </ng-template>\r\n    </ng-container>\r\n\r\n    <div>\r\n      <abp-button (click)="submit(settings.settings)" iconClass="fa fa-save" [loading]="loading">{{\r\n        \'AbpAccount::Save\' | abpLocalization\r\n      }}</abp-button>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n',changeDetection:ChangeDetectionStrategy.OnPush,providers:[{provide:AbstractAccountSettingsService,useClass:AccountExternalProviderService}]}]}];