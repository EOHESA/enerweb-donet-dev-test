!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@abp/ng.core"),require("@abp/ng.theme.shared"),require("@abp/ng.theme.shared/extensions"),require("@angular/core"),require("@ng-bootstrap/ng-bootstrap"),require("@angular/forms"),require("rxjs/operators"),require("rxjs")):"function"==typeof define&&define.amd?define("@volo/abp.commercial.ng.ui",["exports","@abp/ng.core","@abp/ng.theme.shared","@abp/ng.theme.shared/extensions","@angular/core","@ng-bootstrap/ng-bootstrap","@angular/forms","rxjs/operators","rxjs"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).volo=t.volo||{},t.volo.abp=t.volo.abp||{},t.volo.abp.commercial=t.volo.abp.commercial||{},t.volo.abp.commercial.ng=t.volo.abp.commercial.ng||{},t.volo.abp.commercial.ng.ui={}),t.ng_core,t.ng_theme_shared,t.extensions,t.ng.core,t.ngBootstrap,t.ng.forms,t.rxjs.operators,t.rxjs)}(this,(function(t,e,n,o,r,a,i,p,l){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function s(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}Object.create;function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i}function d(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}Object.create;var g=function(t){function n(){var e=t.apply(this,d(arguments))||this;return e.lookupNameProp="displayName",e.lookupIdProp="id",e.maxResultCount=10,e.skipCount=0,e.disabled=!1,e}return s(n,t),Object.defineProperty(n.prototype,"pageQuery",{get:function(){return this.createRequestDto(this)},set:function(t){Object.assign(this,this.createRequestDto(t))},enumerable:!1,configurable:!0}),n.prototype.createRequestDto=function(t){return new e.PagedAndSortedResultRequestDto({maxResultCount:t.maxResultCount,skipCount:t.skipCount,sorting:t.sorting})},n}(e.AbstractNgModelComponent);g.decorators=[{type:r.Component,args:[{template:""}]}],g.propDecorators={getFn:[{type:r.Input}],lookupNameProp:[{type:r.Input}],lookupIdProp:[{type:r.Input}],maxResultCount:[{type:r.Input}],skipCount:[{type:r.Input}],sorting:[{type:r.Input}],disabled:[{type:r.Input}],cid:[{type:r.Input}]};var m=function(t){function e(e){var n=t.call(this,e)||this;return n.lookupNameProp="displayName",n.displayNameProp="name",n.pickButton={show:!0,disabled:!1},n.clearButton={show:!0,disabled:!1},n.selectedName="",n.ngControl=e.get(i.NgControl),n.ngControl.valueAccessor=n,n}return s(e,t),Object.defineProperty(e.prototype,"isInvalid",{get:function(){return this.ngControl.dirty&&this.ngControl.invalid},enumerable:!1,configurable:!0}),e.prototype.ngAfterViewInit=function(){this.value&&this.editingData&&this.editingData[this.displayNameProp]&&(this.selectedName=this.editingData[this.displayNameProp])},e.prototype.pick=function(t){this.value=t.id,this.selectedName=t[this.lookupNameProp],this.isModalVisible=!1},e.prototype.onClickPick=function(){this.isModalVisible=!0},e.prototype.onClickClear=function(){this.value="",this.selectedName=""},e.prototype.writeValue=function(e){e||(this.selectedName=""),t.prototype.writeValue.call(this,e)},e}(e.AbstractNgModelComponent);m.decorators=[{type:r.Component,args:[{selector:"abp-lookup-input",template:'<div class="input-group">\r\n  <input\r\n    [id]="cid"\r\n    type="text"\r\n    class="form-control"\r\n    disabled\r\n    [ngModel]="selectedName"\r\n    [class.input-validation-error]="isInvalid"\r\n  />\r\n  <div class="input-group-append">\r\n    <button\r\n      *ngIf="pickButton.show"\r\n      [disabled]="pickButton.disabled"\r\n      class="btn btn-info"\r\n      type="button"\r\n      (click)="onClickPick()"\r\n    >\r\n      {{ { key: \'::Pick\', defaultValue: \'Pick\' } | abpLocalization }}\r\n    </button>\r\n    <button\r\n      *ngIf="clearButton.show"\r\n      [disabled]="clearButton.disabled"\r\n      class="btn btn-danger"\r\n      type="button"\r\n      (click)="onClickClear()"\r\n    >\r\n      <i class="fa fa-times"></i>\r\n    </button>\r\n  </div>\r\n</div>\r\n\r\n<abp-modal [(visible)]="isModalVisible">\r\n  <ng-template #abpHeader>\r\n    <h3>{{ { key: \'::Pick\', defaultValue: \'Pick\' } | abpLocalization }}</h3>\r\n  </ng-template>\r\n\r\n  <ng-template #abpBody>\r\n    <abp-lookup-table\r\n      [getFn]="getFn"\r\n      [lookupNameProp]="lookupNameProp"\r\n      (pick)="pick($event)"\r\n    ></abp-lookup-table>\r\n  </ng-template>\r\n\r\n  <ng-template #abpFooter>\r\n    <button type="button" class="btn btn-secondary" #abpClose>\r\n      {{ \'AbpUi::Cancel\' | abpLocalization }}\r\n    </button>\r\n  </ng-template>\r\n</abp-modal>\r\n'}]}],m.ctorParameters=function(){return[{type:r.Injector}]},m.propDecorators={getFn:[{type:r.Input}],lookupNameProp:[{type:r.Input}],displayNameProp:[{type:r.Input}],editingData:[{type:r.Input}],pickButton:[{type:r.Input}],clearButton:[{type:r.Input}],cid:[{type:r.Input}]};var b=function(t){function e(e){var n=t.call(this,e)||this;return n.maxResultCount=1e3,n.datas=[],n.ngControl=e.get(i.NgControl),n.ngControl.valueAccessor=n,n}return s(e,t),Object.defineProperty(e.prototype,"isInvalid",{get:function(){return this.ngControl.dirty&&this.ngControl.invalid},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.get()},e.prototype.get=function(){var t=this;this.getFn(this.pageQuery).subscribe((function(e){var n=e.items;t.datas=n}))},e}(g);b.decorators=[{type:r.Component,args:[{selector:"abp-lookup-select",template:'<select\r\n  [id]="cid"\r\n  class="custom-select form-control"\r\n  [(ngModel)]="value"\r\n  [abpDisabled]="disabled"\r\n  [class.input-validation-error]="isInvalid"\r\n>\r\n  <option [ngValue]=""></option>\r\n  <option *ngFor="let data of datas" [ngValue]="data[lookupIdProp]">\r\n    {{ data[lookupNameProp] }}\r\n  </option>\r\n</select>\r\n'}]}],b.ctorParameters=function(){return[{type:r.Injector}]},b.propDecorators={maxResultCount:[{type:r.Input}]};var y=function(){function t(){this.lookupNameProp="displayName",this.pick=new r.EventEmitter,this.data=[],this.totalCount=0,this.pageQuery={maxResultCount:10,skipCount:0,filter:""}}return t.prototype.ngOnInit=function(){this.get()},t.prototype.get=function(){var t=this;this.loading=!0,this.getFn(this.pageQuery).pipe(p.finalize((function(){return t.loading=!1}))).subscribe((function(e){var n=e.totalCount,o=e.items;t.data=o,t.totalCount=n}))},t.prototype.pageChange=function(t){this.pageQuery.skipCount=this.pageQuery.maxResultCount*(t-1),this.get()},t}();y.decorators=[{type:r.Component,args:[{selector:"abp-lookup-table",template:'<div class="card">\r\n  <div class="card-body">\r\n    <div id="data-tables-table-filter" class="data-tables-filter">\r\n      <label\r\n        ><input\r\n          type="search"\r\n          class="form-control"\r\n          [placeholder]="\'AbpUi::PagerSearch\' | abpLocalization"\r\n          [(ngModel)]="pageQuery.filter"\r\n          (input.debounce)="get()"\r\n      /></label>\r\n    </div>\r\n    <abp-table\r\n      [abpLoading]="loading"\r\n      [abpLoadingDelay]="500"\r\n      [colgroupTemplate]="tableColgroup"\r\n      [bodyTemplate]="tableBody"\r\n      [value]="data"\r\n      [rows]="pageQuery.maxResultCount"\r\n      [totalRecords]="totalCount"\r\n      [scrollable]="true"\r\n      (pageChange)="pageChange($event)"\r\n    >\r\n    </abp-table>\r\n    <ng-template #tableColgroup>\r\n      <colgroup>\r\n        <col [ngStyle]="{ \'width.px\': 150 }" />\r\n      </colgroup>\r\n    </ng-template>\r\n    <ng-template #tableBody let-data>\r\n      <tr>\r\n        <td class="text-center">\r\n          <button class="btn btn-primary btn-sm" type="button" (click)="pick.emit(data)">\r\n            {{ \'::Pick\' | abpLocalization }}\r\n          </button>\r\n        </td>\r\n        <td>{{ data[lookupNameProp] }}</td>\r\n      </tr>\r\n    </ng-template>\r\n  </div>\r\n</div>\r\n'}]}],y.propDecorators={getFn:[{type:r.Input}],lookupNameProp:[{type:r.Input}],pick:[{type:r.Output}]};var f=function(t){function n(e){var n=t.call(this,e)||this;return n.displayNameProp="name",n.lookupFilterProp="filter",n.filter="",n.createItemToOptionMapper=function(t){return function(e){var o;return(o={})[n.lookupNameProp]=e[t],o[n.lookupIdProp]=e[n.lookupIdProp],o}},n.mapDataToOption=function(t){return n.createItemToOptionMapper(n.displayNameProp)(t)},n.mapResponseToOptions=function(t){return t.items.map(n.createItemToOptionMapper(n.lookupNameProp))},n.search=function(t){return t?t.pipe(p.debounceTime(300),p.distinctUntilChanged(),p.tap((function(t){return n.filter=t})),p.switchMap((function(t){return t?n.getFn(n.pageQuery):l.of({items:[]})})),p.map(n.mapResponseToOptions)):l.of([])},n.typeaheadFormatter=function(t){return t[n.lookupNameProp]},n.ngControl=e.get(i.NgControl),n.ngControl.valueAccessor=n,n}return s(n,t),Object.defineProperty(n.prototype,"model",{get:function(){return this._model},set:function(t){this._model=t;var e=t?t[this.lookupIdProp]:null;e!==this.value&&(this.value=e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isInvalid",{get:function(){return this.ngControl.dirty&&this.ngControl.invalid},enumerable:!1,configurable:!0}),n.prototype.createRequestDto=function(t){var n;return Object.assign(new e.PagedAndSortedResultRequestDto({maxResultCount:t.maxResultCount,skipCount:t.skipCount,sorting:t.sorting}),((n={})[this.lookupFilterProp]=t.filter,n))},n.prototype.ngOnChanges=function(t){var e=t.editingData;if(e){var n=e.currentValue;this.model=n?this.mapDataToOption(n):void 0}},n.prototype.writeValue=function(e){e||(this._model=void 0),t.prototype.writeValue.call(this,e)},n}(g);f.decorators=[{type:r.Component,args:[{selector:"abp-lookup-typeahead",template:'<div class="position-relative">\r\n  <input\r\n    #typeahead\r\n    [id]="cid"\r\n    [abpDisabled]="disabled"\r\n    [ngbTypeahead]="search"\r\n    [editable]="false"\r\n    [inputFormatter]="typeaheadFormatter"\r\n    [resultFormatter]="typeaheadFormatter"\r\n    [(ngModel)]="model"\r\n    (blur)="value || (typeahead.value = null)"\r\n    class="form-control"\r\n    [class.input-validation-error]="isInvalid"\r\n  />\r\n</div>\r\n'}]}],f.ctorParameters=function(){return[{type:r.Injector}]},f.propDecorators={displayNameProp:[{type:r.Input}],lookupFilterProp:[{type:r.Input}],filter:[{type:r.Input}],editingData:[{type:r.Input}]};var h=function(){};h.decorators=[{type:r.NgModule,args:[{exports:[g,y,m,b,f,o.UiExtensionsModule],declarations:[g,y,m,b,f],imports:[e.CoreModule,n.ThemeSharedModule,o.UiExtensionsModule,a.NgbTypeaheadModule]}]}];var v=function(){};v.decorators=[{type:r.NgModule,args:[{exports:[h],imports:[h]}]}];var C=function(t){function e(e){return void 0===e&&(e={}),t.call(this,e)||this}return s(e,t),e}(e.ExtensibleCreationAuditedEntityDto),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(e.PagedAndSortedResultRequestDto),I=new r.InjectionToken("SHOW_ENTITY_HISTORY"),P=new r.InjectionToken("PROFILE_PICTURE",{providedIn:"root",factory:function(){return new l.BehaviorSubject({type:"image",source:null})}});t.BaseCommercialUiModule=h,t.CommercialUiModule=v,t.IdentitySecurityLogDto=C,t.IdentitySecurityLogGetListInput=k,t.LookupInputComponent=m,t.LookupSelectComponent=b,t.LookupTableComponent=y,t.PROFILE_PICTURE=P,t.SHOW_ENTITY_HISTORY=I,t.ɵa=g,t.ɵb=f,Object.defineProperty(t,"__esModule",{value:!0})}));