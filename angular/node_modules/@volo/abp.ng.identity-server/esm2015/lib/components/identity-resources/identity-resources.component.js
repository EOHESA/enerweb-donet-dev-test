import{ListService}from"@abp/ng.core";import{Confirmation,ConfirmationService}from"@abp/ng.theme.shared";import{EXTENSIONS_IDENTIFIER,FormPropData,generateFormFromProps}from"@abp/ng.theme.shared/extensions";import{Component,Injector}from"@angular/core";import{FormBuilder,Validators}from"@angular/forms";import{take,switchMap,filter}from"rxjs/operators";import{IdentityResourcesService}from"../../proxy/identity-resources.service";const ɵ0="IdentityServer.IdentityResourcesComponent";export class IdentityResourcesComponent{constructor(e,t,r,i,s){this.list=e,this.service=t,this.confirmationService=r,this.fb=i,this.injector=s,this.createModalVisible=!1,this.editModalVisible=!1}ngOnInit(){}onAdd(){this.newScopeForm=this.fb.group({name:["",[Validators.required]],displayName:[""],description:[""],required:[!1],enabled:[!0],emphasize:[!1],showInDiscoveryDocument:[!0]}),this.createModalVisible=!0}create(e){this.service.create(Object.assign(Object.assign({},e),{properties:[]})).pipe(take(1)).subscribe(e=>{this.createModalVisible=!1,this.list.get()})}onEdit(e){this.service.get(e).pipe(take(1)).subscribe(e=>{this.editSelectedRecord=e;const t=new FormPropData(this.injector,e);this.editScopeForm=generateFormFromProps(t),this.editClaims=e.userClaims.map(e=>({id:e.identityResourceId,name:e.type,left:!0})),this.editProperties=e.properties,this.editModalVisible=!0})}edit(e){this.service.update(this.editSelectedRecord.id,e).pipe(take(1)).subscribe(e=>{this.editModalVisible=!1,this.list.get()})}onCreateStandardResources(){this.confirmationService.warn("AbpIdentityServer::CreateStandardIdentityResourcesWarningMessage","AbpIdentityServer::AreYouSure").pipe(filter(e=>e===Confirmation.Status.confirm),switchMap(e=>this.service.createStandardResources()),take(1)).subscribe()}delete(e,t){this.confirmationService.warn("AbpIdentityServer::IdentityResourcesDeletionWarningMessage","AbpIdentityServer::AreYouSure",{messageLocalizationParams:[t]}).pipe(filter(e=>e===Confirmation.Status.confirm),switchMap(t=>this.service.delete(e)),take(1)).subscribe(e=>{this.list.get()})}}IdentityResourcesComponent.decorators=[{type:Component,args:[{selector:"abp-identity-resources",template:'<abp-identity-server-entity-base\r\n  [list]="list"\r\n  [service]="service"\r\n  entityName="IdentityResources"\r\n></abp-identity-server-entity-base>\r\n\r\n<abp-identity-server-modal\r\n  *ngIf="createModalVisible"\r\n  [(visible)]="createModalVisible"\r\n  (save)="create($event)"\r\n>\r\n  <abp-identity-server-modal-info-tab [form]="newScopeForm"></abp-identity-server-modal-info-tab>\r\n  <abp-identity-server-modal-claims-tab></abp-identity-server-modal-claims-tab>\r\n</abp-identity-server-modal>\r\n\r\n<abp-identity-server-modal\r\n  *ngIf="editModalVisible"\r\n  [(visible)]="editModalVisible"\r\n  (save)="edit($event)"\r\n  type="Edit"\r\n>\r\n  <abp-identity-server-modal-info-tab\r\n    [form]="editScopeForm"\r\n    [selectedRecord]="editSelectedRecord"\r\n  ></abp-identity-server-modal-info-tab>\r\n  <abp-identity-server-modal-claims-tab\r\n    [claims]="editClaims"\r\n  ></abp-identity-server-modal-claims-tab>\r\n  <abp-identity-server-modal-properties-tab\r\n    [selectedProperties]="editProperties"\r\n  ></abp-identity-server-modal-properties-tab>\r\n</abp-identity-server-modal>\r\n',providers:[ListService,{provide:EXTENSIONS_IDENTIFIER,useValue:ɵ0}]}]}],IdentityResourcesComponent.ctorParameters=()=>[{type:ListService},{type:IdentityResourcesService},{type:ConfirmationService},{type:FormBuilder},{type:Injector}];export{ɵ0};