import{Component,Injector}from"@angular/core";import{FormBuilder,Validators}from"@angular/forms";import{ListService}from"@abp/ng.core";import{filter,switchMap,take}from"rxjs/operators";import{EXTENSIONS_IDENTIFIER,FormPropData,generateFormFromProps}from"@abp/ng.theme.shared/extensions";import{Confirmation,ConfirmationService}from"@abp/ng.theme.shared";import{ApiScopesService}from"../../proxy/api-scopes.service";const ɵ0="IdentityServer.ApiScopesComponent";export class ApiScopesComponent{constructor(e,i,t,r,s){this.list=e,this.service=i,this.fb=t,this.confirmationService=r,this.injector=s,this.createModalVisible=!1,this.editModalVisible=!1}ngOnInit(){}onEdit(e){this.service.get(e).pipe(take(1)).subscribe(e=>{this.editSelectedRecord=e;const i=new FormPropData(this.injector,e);this.editScopeForm=generateFormFromProps(i),this.editClaims=e.userClaims.map(e=>({id:e.apiScopeId,name:e.type,left:!0})),this.editModalVisible=!0})}delete(e,i){this.confirmationService.warn("AbpIdentityServer::ApiScopesDeletionWarningMessage","AbpIdentityServer::AreYouSure",{messageLocalizationParams:[i]}).pipe(filter(e=>e===Confirmation.Status.confirm),switchMap(i=>this.service.delete(e)),take(1)).subscribe(e=>{this.list.get()})}onAdd(){this.newScopeForm=this.fb.group({name:["",[Validators.required]],displayName:[""],description:[""],required:[!1],enabled:[!1],emphasize:[!1],showInDiscoveryDocument:[!1]}),this.createModalVisible=!0}create(e){this.service.create(Object.assign(Object.assign({},e),{properties:[]})).pipe(take(1)).subscribe(e=>{this.createModalVisible=!1,this.list.get()})}edit(e){this.service.update(this.editSelectedRecord.id,e).pipe(take(1)).subscribe(e=>{this.editModalVisible=!1,this.list.get()})}}ApiScopesComponent.decorators=[{type:Component,args:[{selector:"abp-api-scopes",template:'<abp-identity-server-entity-base\r\n  [list]="list"\r\n  [service]="service"\r\n  entityName="ApiScopes"\r\n></abp-identity-server-entity-base>\r\n\r\n<abp-identity-server-modal\r\n  *ngIf="createModalVisible"\r\n  [(visible)]="createModalVisible"\r\n  (save)="create($event)"\r\n>\r\n  <abp-identity-server-modal-info-tab [form]="newScopeForm"></abp-identity-server-modal-info-tab>\r\n  <abp-identity-server-modal-claims-tab></abp-identity-server-modal-claims-tab>\r\n</abp-identity-server-modal>\r\n\r\n<abp-identity-server-modal\r\n  *ngIf="editModalVisible"\r\n  [(visible)]="editModalVisible"\r\n  (save)="edit($event)"\r\n  type="Edit"\r\n>\r\n  <abp-identity-server-modal-info-tab\r\n    [form]="editScopeForm"\r\n    [selectedRecord]="editSelectedRecord"\r\n  ></abp-identity-server-modal-info-tab>\r\n  <abp-identity-server-modal-claims-tab\r\n    [claims]="editClaims"\r\n  ></abp-identity-server-modal-claims-tab>\r\n  <abp-identity-server-modal-properties-tab\r\n    [selectedProperties]="editSelectedRecord.properties"\r\n  ></abp-identity-server-modal-properties-tab>\r\n</abp-identity-server-modal>\r\n',providers:[ListService,{provide:EXTENSIONS_IDENTIFIER,useValue:ɵ0}]}]}],ApiScopesComponent.ctorParameters=()=>[{type:ListService},{type:ApiScopesService},{type:FormBuilder},{type:ConfirmationService},{type:Injector}];export{ɵ0};