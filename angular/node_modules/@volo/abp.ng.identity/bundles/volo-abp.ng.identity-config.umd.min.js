!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@abp/ng.core"),require("@abp/ng.theme.shared"),require("@angular/core"),require("@angular/forms"),require("@ngxs/store"),require("rxjs/operators"),require("snq")):"function"==typeof define&&define.amd?define("@volo/abp.ng.identity/config",["exports","@abp/ng.core","@abp/ng.theme.shared","@angular/core","@angular/forms","@ngxs/store","rxjs/operators","snq"],n):n(((e="undefined"!=typeof globalThis?globalThis:e||self).volo=e.volo||{},e.volo.abp=e.volo.abp||{},e.volo.abp.ng=e.volo.abp.ng||{},e.volo.abp.ng.identity=e.volo.abp.ng.identity||{},e.volo.abp.ng.identity.config={}),e.i1,e.ng_theme_shared,e.ng.core,e.ng.forms,e.store,e.rxjs.operators,e.snq)}(this,(function(e,n,r,t,i,o,a,s){"use strict";var l=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(s),c=function(){function e(e){this.restService=e,this.apiName="AbpIdentity"}return e.prototype.getSettings=function(){return this.restService.request({method:"GET",url:"/api/identity/settings"},{apiName:this.apiName})},e.prototype.updateSettings=function(e){return this.restService.request({method:"PUT",url:"/api/identity/settings",body:e},{apiName:this.apiName})},e}();c.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new c(t.ɵɵinject(n.RestService))},token:c,providedIn:"root"}),c.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],c.ctorParameters=function(){return[{type:n.RestService}]};var d=i.Validators.required,u=i.Validators.max,m=i.Validators.min,p=function(){function e(e,n,r,t,i,o,a){var s=this;this.identityConfigService=e,this.toaster=n,this.fb=r,this.store=t,this.subscription=i,this.configState=o,this.appConfigService=a,this.settings={},this.doNotRequireConfirmedPhoneNumber=function(){s.form.get("signIn.requireConfirmedPhoneNumber").setValue(!1)},this.enablePhoneNumberConfirmation=function(){s.form.get("signIn.enablePhoneNumberConfirmation").setValue(!0)},e.getSettings().subscribe((function(e){s.settings=e,s.buildForm(),s.syncConfirmationOptions()}))}return Object.defineProperty(e.prototype,"initialized",{get:function(){return"{}"!==JSON.stringify(this.settings)},enumerable:!1,configurable:!0}),e.prototype.buildForm=function(){var e=this,n=l.default((function(){return e.settings.password}),{}),r=this.fb.group({requiredLength:[n.requiredLength,[d,u(32),m(2)]],requiredUniqueChars:[n.requiredUniqueChars,[d,u(32),m(1)]],requireNonAlphanumeric:n.requireNonAlphanumeric,requireLowercase:n.requireLowercase,requireUppercase:n.requireUppercase,requireDigit:n.requireDigit}),t=l.default((function(){return e.settings.lockout}),{}),i=this.fb.group({allowedForNewUsers:t.allowedForNewUsers,lockoutDuration:[t.lockoutDuration,[d]],maxFailedAccessAttempts:[t.maxFailedAccessAttempts,[d]]}),o=l.default((function(){return e.settings.signIn}),{}),a=this.fb.group({requireConfirmedEmail:o.requireConfirmedEmail,enablePhoneNumberConfirmation:o.enablePhoneNumberConfirmation,requireConfirmedPhoneNumber:o.requireConfirmedPhoneNumber}),s=l.default((function(){return e.settings.user}),{}),c=this.fb.group({isUserNameUpdateEnabled:s.isUserNameUpdateEnabled,isEmailUpdateEnabled:s.isEmailUpdateEnabled});this.form=this.fb.group({password:r,lockout:i,signIn:a,user:c})},e.prototype.syncConfirmationOptions=function(){this.subscription.addOne(this.form.get("signIn.requireConfirmedPhoneNumber").valueChanges.pipe(a.filter(Boolean)),this.enablePhoneNumberConfirmation),this.subscription.addOne(this.form.get("signIn.enablePhoneNumberConfirmation").valueChanges.pipe(a.filter((function(e){return!e}))),this.doNotRequireConfirmedPhoneNumber)},e.prototype.submit=function(){var e=this;this.loading=!0,this.identityConfigService.updateSettings(this.form.value).pipe(a.finalize((function(){e.loading=!1,e.appConfigService.getConfiguration().subscribe((function(n){return e.configState.setState(n)}))}))).subscribe((function(){return e.toaster.success("AbpIdentity::SavedSuccessfully",null)}))},e}();p.decorators=[{type:t.Component,args:[{selector:"abp-identity-settings",template:'<h2>{{ \'AbpIdentity::Menu:IdentityManagement\' | abpLocalization }}</h2>\r\n<hr class="my-4" />\r\n<form\r\n  *ngIf="form"\r\n  id="IdentitySettingsForm"\r\n  [formGroup]="form"\r\n  (ngSubmit)="submit()"\r\n  validateOnSubmit\r\n>\r\n  <div class="row">\r\n    <div class="col-md-12">\r\n      <div formGroupName="password">\r\n        <h4>{{ \'AbpIdentity::PasswordSettings\' | abpLocalization }}</h4>\r\n        <div class="form-group">\r\n          <label for="Password_RequiredLength">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.Password.RequiredLength\' | abpLocalization\r\n          }}</label\r\n          ><input\r\n            type="number"\r\n            id="Password_RequiredLength"\r\n            name="Password.RequiredLength"\r\n            class="form-control"\r\n            formControlName="requiredLength"\r\n            min="2"\r\n            max="32"\r\n          />\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.Password.RequiredLength\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="form-group">\r\n          <label for="Password_RequiredUniqueChars">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.Password.RequiredUniqueChars\' | abpLocalization\r\n          }}</label\r\n          ><input\r\n            type="number"\r\n            id="Password_RequiredUniqueChars"\r\n            name="Password.RequiredUniqueChars"\r\n            class="form-control"\r\n            formControlName="requiredUniqueChars"\r\n            min="0"\r\n            max="32"\r\n          />\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.Password.RequiredUniqueChars\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="Password_RequireNonAlphanumeric"\r\n            name="Password.RequireNonAlphanumeric"\r\n            class="custom-control-input "\r\n            formControlName="requireNonAlphanumeric"\r\n          /><label class="custom-control-label" for="Password_RequireNonAlphanumeric">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.Password.RequireNonAlphanumeric\'\r\n              | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.Password.RequireNonAlphanumeric\'\r\n              | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="Password_RequireLowercase"\r\n            name="Password.RequireLowercase"\r\n            class="custom-control-input "\r\n            formControlName="requireLowercase"\r\n          /><label class="custom-control-label" for="Password_RequireLowercase">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.Password.RequireLowercase\' | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.Password.RequireLowercase\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="Password_RequireUppercase"\r\n            name="Password.RequireUppercase"\r\n            class="custom-control-input "\r\n            formControlName="requireUppercase"\r\n          /><label class="custom-control-label" for="Password_RequireUppercase">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.Password.RequireUppercase\' | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.Password.RequireUppercase\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="Password_RequireDigit"\r\n            name="Password.RequireDigit"\r\n            class="custom-control-input "\r\n            formControlName="requireDigit"\r\n          /><label class="custom-control-label" for="Password_RequireDigit">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.Password.RequireDigit\' | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.Password.RequireDigit\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n      </div>\r\n      <hr class="my-4" />\r\n      <div formGroupName="lockout">\r\n        <h4>{{ \'AbpIdentity::LockoutSettings\' | abpLocalization }}</h4>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="Lockout_AllowedForNewUsers"\r\n            name="Lockout.AllowedForNewUsers"\r\n            class="custom-control-input "\r\n            formControlName="allowedForNewUsers"\r\n          /><label class="custom-control-label" for="Lockout_AllowedForNewUsers">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.Lockout.AllowedForNewUsers\' | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.Lockout.AllowedForNewUsers\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="form-group">\r\n          <label for="Lockout_LockoutDuration">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.Lockout.LockoutDuration\' | abpLocalization\r\n          }}</label\r\n          ><input\r\n            type="number"\r\n            id="Lockout_LockoutDuration"\r\n            name="Lockout.LockoutDuration"\r\n            class="form-control"\r\n            formControlName="lockoutDuration"\r\n          />\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.Lockout.LockoutDuration\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="form-group">\r\n          <label for="Lockout_MaxFailedAccessAttempts">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.Lockout.MaxFailedAccessAttempts\'\r\n              | abpLocalization\r\n          }}</label\r\n          ><input\r\n            type="number"\r\n            id="Lockout_MaxFailedAccessAttempts"\r\n            name="Lockout.MaxFailedAccessAttempts"\r\n            class="form-control"\r\n            formControlName="maxFailedAccessAttempts"\r\n          />\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.Lockout.MaxFailedAccessAttempts\'\r\n              | abpLocalization\r\n          }}</small>\r\n        </div>\r\n      </div>\r\n      <hr class="my-4" />\r\n      <div formGroupName="signIn">\r\n        <h4>{{ \'AbpIdentity::SignInSettings\' | abpLocalization }}</h4>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="SignIn_RequireConfirmedEmail"\r\n            name="SignIn.RequireConfirmedEmail"\r\n            class="custom-control-input "\r\n            formControlName="requireConfirmedEmail"\r\n          /><label class="custom-control-label" for="SignIn_RequireConfirmedEmail">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.SignIn.RequireConfirmedEmail\' | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.SignIn.RequireConfirmedEmail\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="SignIn_EnablePhoneNumberConfirmation"\r\n            name="SignIn.EnablePhoneNumberConfirmation"\r\n            class="custom-control-input "\r\n            formControlName="enablePhoneNumberConfirmation"\r\n          /><label class="custom-control-label" for="SignIn_EnablePhoneNumberConfirmation">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.SignIn.EnablePhoneNumberConfirmation\'\r\n              | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.SignIn.EnablePhoneNumberConfirmation\'\r\n              | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="SignIn_RequireConfirmedPhoneNumber"\r\n            name="SignIn.RequireConfirmedPhoneNumber"\r\n            class="custom-control-input "\r\n            formControlName="requireConfirmedPhoneNumber"\r\n          /><label class="custom-control-label" for="SignIn_RequireConfirmedPhoneNumber">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.SignIn.RequireConfirmedPhoneNumber\'\r\n              | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.SignIn.RequireConfirmedPhoneNumber\'\r\n              | abpLocalization\r\n          }}</small>\r\n        </div>\r\n      </div>\r\n      <hr class="my-4" />\r\n      <div formGroupName="user">\r\n        <h4>{{ \'AbpIdentity::UserSettings\' | abpLocalization }}</h4>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="User_IsEmailUpdateEnabled"\r\n            name="User.IsEmailUpdateEnabled"\r\n            class="custom-control-input "\r\n            formControlName="isEmailUpdateEnabled"\r\n          /><label class="custom-control-label" for="User_IsEmailUpdateEnabled">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.User.IsEmailUpdateEnabled\' | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.User.IsEmailUpdateEnabled\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n        <div class="custom-checkbox custom-control mb-2">\r\n          <input\r\n            type="checkbox"\r\n            id="User_IsUserNameUpdateEnabled"\r\n            name="User.IsUserNameUpdateEnabled"\r\n            class="custom-control-input "\r\n            formControlName="isUserNameUpdateEnabled"\r\n          /><label class="custom-control-label" for="User_IsUserNameUpdateEnabled">{{\r\n            \'AbpIdentity::DisplayName:Abp.Identity.User.IsUserNameUpdateEnabled\' | abpLocalization\r\n          }}</label>\r\n          <small class="form-text text-muted">{{\r\n            \'AbpIdentity::Description:Abp.Identity.User.IsUserNameUpdateEnabled\' | abpLocalization\r\n          }}</small>\r\n        </div>\r\n      </div>\r\n      <hr class="my-4" />\r\n      <div>\r\n        <abp-button\r\n          iconClass="fa fa-save"\r\n          [loading]="loading"\r\n          buttonType="submit"\r\n          [disabled]="form?.invalid"\r\n        >\r\n          {{ \'AbpIdentity::Save\' | abpLocalization }}\r\n        </abp-button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</form>\r\n',providers:[n.SubscriptionService]}]}],p.ctorParameters=function(){return[{type:c},{type:r.ToasterService},{type:i.FormBuilder},{type:o.Store},{type:n.SubscriptionService},{type:n.ConfigStateService},{type:n.ApplicationConfigurationService}]};var b=[{provide:t.APP_INITIALIZER,useFactory:y,deps:[n.RoutesService],multi:!0}];function y(e){return function(){e.add([{path:"/identity",name:"AbpIdentity::Menu:IdentityManagement",parentName:"AbpUiNavigation::Menu:Administration",order:2,layout:"application",iconClass:"fa fa-id-card-o",requiredPolicy:"AbpIdentity.Roles || AbpIdentity.Users || AbpIdentity.ClaimTypes || AbpIdentity.OrganizationUnits"},{path:"/identity/organization-units",name:"AbpIdentity::OrganizationUnits",parentName:"AbpIdentity::Menu:IdentityManagement",order:1,requiredPolicy:"AbpIdentity.OrganizationUnits"},{path:"/identity/roles",name:"AbpIdentity::Roles",parentName:"AbpIdentity::Menu:IdentityManagement",order:2,requiredPolicy:"AbpIdentity.Roles"},{path:"/identity/users",name:"AbpIdentity::Users",parentName:"AbpIdentity::Menu:IdentityManagement",order:3,requiredPolicy:"AbpIdentity.Users"},{path:"/identity/claim-types",name:"AbpIdentity::ClaimTypes",parentName:"AbpIdentity::Menu:IdentityManagement",order:4,requiredPolicy:"AbpIdentity.ClaimTypes"},{path:"/identity/security-logs",name:"AbpIdentity::SecurityLogs",parentName:"AbpIdentity::Menu:IdentityManagement",order:4,requiredPolicy:"AbpIdentity.SecurityLogs"}])}}var f=[{provide:t.APP_INITIALIZER,useFactory:I,deps:[n.SettingTabsService],multi:!0}];function I(e){return function(){e.add([{name:"AbpIdentity::Menu:IdentityManagement",order:1,requiredPolicy:"AbpIdentity.SettingManagement",component:p}])}}var g=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[b,f]}},e}();g.decorators=[{type:t.NgModule,args:[{exports:[p],entryComponents:[p],declarations:[p],imports:[n.CoreModule,r.ThemeSharedModule]}]}],e.IDENTITY_ROUTE_PROVIDERS=b,e.IDENTITY_SETTING_TAB_PROVIDERS=f,e.IdentityConfigModule=g,e.IdentityConfigService=c,e.IdentitySettingsComponent=p,e.configureRoutes=y,e.configureSettingTabs=I,e.ɵa=p,e.ɵb=c,e.ɵc=b,e.ɵd=y,e.ɵe=f,e.ɵf=I,Object.defineProperty(e,"__esModule",{value:!0})}));